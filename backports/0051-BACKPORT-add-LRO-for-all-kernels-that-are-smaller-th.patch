From: Erez Shitrit <erezsh@mellanox.com>
Subject: [PATCH] BACKPORT: add LRO for all kernels that are smaller than 3.3

issue: 190246

Signed-off-by: Erez Shitrit <erezsh@mellanox.com>
---
 drivers/infiniband/ulp/ipoib/ipoib_ethtool.c |    9 ++++++++-
 1 files changed, 8 insertions(+), 1 deletions(-)

diff --git a/drivers/infiniband/ulp/ipoib/ipoib_ethtool.c b/drivers/infiniband/ulp/ipoib/ipoib_ethtool.c
index xxxxxxx..xxxxxxx xxxxxx
--- a/drivers/infiniband/ulp/ipoib/ipoib_ethtool.c
+++ b/drivers/infiniband/ulp/ipoib/ipoib_ethtool.c
@@ -457,7 +457,14 @@ static int ipoib_set_channels(struct net_device *dev,
 }
 #endif
 
-#ifdef CONFIG_COMPAT_USE_LRO
+#if (LINUX_VERSION_CODE >= KERNEL_VERSION(2,6,36)) && defined (CONFIG_COMPAT_USE_LRO)
+int ipoib_set_flags(struct net_device *dev, u32 data, u32 supported)
+{
+       	ethtool_op_set_flags(dev, data, supported);
+       	
+	return 0;
+}
+#elif defined (CONFIG_COMPAT_USE_LRO)
 int ipoib_set_flags(struct net_device *dev, u32 data)
 {
        	ethtool_op_set_flags(dev, data);
