From: Erez Shitrit <erezsh@mellanox.com>
Subject: [PATCH] BACKPORT: enable NETIF_F_LRO on hw_features

issue:350477

Signed-off-by: Erez Shitrit <erezsh@mellanox.com>
---
 drivers/infiniband/ulp/ipoib/ipoib_main.c |    4 ++++
 1 files changed, 4 insertions(+), 0 deletions(-)

diff --git a/drivers/infiniband/ulp/ipoib/ipoib_main.c b/drivers/infiniband/ulp/ipoib/ipoib_main.c
index xxxxxxx..xxxxxxx xxxxxx
--- a/drivers/infiniband/ulp/ipoib/ipoib_main.c
+++ b/drivers/infiniband/ulp/ipoib/ipoib_main.c
@@ -2042,7 +2042,11 @@ static void ipoib_lro_setup(struct ipoib_recv_ring *recv_ring,
 void set_lro_features_bit(struct ipoib_dev_priv *priv)
 {
 	if (lro)
+#if (LINUX_VERSION_CODE < KERNEL_VERSION(3,1,0))
 		priv->dev->features |= NETIF_F_LRO;
+#else
+	priv->dev->hw_features |= NETIF_F_LRO;
+#endif
 }
 #endif
 
